From cf23ad429da3213fd3b1261c546dfa08e7dba2bf Mon Sep 17 00:00:00 2001
From: usa <usa@b2dd03c8-39d4-4d8f-98ff-823fe69b080e>
Date: Wed, 27 Apr 2016 13:17:50 +0000
Subject: [PATCH] * compile.c (new_label_body): missed backporting r54548 in
 r54698.   this fixes randomly test failure introduced by r54698.   cf. [Bug
 #12082]

git-svn-id: svn+ssh://ci.ruby-lang.org/ruby/branches/ruby_2_2@54799 b2dd03c8-39d4-4d8f-98ff-823fe69b080e
---
 ChangeLog | 6 ++++++
 compile.c | 2 ++
 2 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/ChangeLog b/ChangeLog
index 2cfdb2c2..fe09b1e 100644
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,3 +1,9 @@
+Wed Apr 27 22:16:04 2016  NAKAMURA Usaku  <usa@ruby-lang.org>
+
+	* compile.c (new_label_body): missed backporting r54548 in r54698.
+	  this fixes randomly test failure introduced by r54698.
+	  cf. [Bug #12082]
+
 Fri Apr 29 20:11:38 2016  Tanaka Akira  <akr@fsij.org>
 
 	* test/ruby/test_time_tz.rb: Tests depends on Europe/Moscow removed
diff --git a/compile.c b/compile.c
index 001152a..cc8e748 100644
--- a/compile.c
+++ b/compile.c
@@ -929,6 +929,8 @@ new_label_body(rb_iseq_t *iseq, long line)
     labelobj->label_no = iseq->compile_data->label_no++;
     labelobj->sc_state = 0;
     labelobj->sp = -1;
+    labelobj->set = 0;
+    labelobj->rescued = LABEL_RESCUE_NONE;
     return labelobj;
 }
 
